<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Wandb Your machine learning project.<!-- --> | aaditya&#x27;s blog</title><meta name="description" content="This post is about Datasets, Machine Learning, Visualization, training, Deep Learning, ML tools, tensorboard, python ."/><meta property="og:title" content="My Personal blog site."/><meta property="og:description" content="This post is about Datasets, Machine Learning, Visualization, training, Deep Learning, ML tools, tensorboard, python ."/><meta property="og:url" content="https://aadityachapagain.com//posts/wandb-your-machine-learning-project"/><meta property="og:type" content="website"/><meta name="keywords" content="Datasets"/><meta name="keywords" content=" Machine Learning"/><meta name="keywords" content=" Visualization"/><meta name="keywords" content=" training"/><meta name="keywords" content=" Deep Learning"/><meta name="keywords" content=" ML tools"/><meta name="keywords" content=" tensorboard"/><meta name="keywords" content=" python"/><meta name="next-head-count" content="16"/><meta charSet="utf-8"/><meta name="robots" content="follow, index"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><link rel="preload" href="/_next/static/css/77a0a18464211215.css" as="style"/><link rel="stylesheet" href="/_next/static/css/77a0a18464211215.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-59c5c889f52620d6.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-10779d2dcf90bfb3.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6c8f3d4aed99a8b2.js" defer=""></script><script src="/_next/static/chunks/281-2503d455e5b415a8.js" defer=""></script><script src="/_next/static/chunks/113-e447bd8132396402.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-3f32a22c118677b3.js" defer=""></script><script src="/_next/static/nGLXNeF8szeowtdfA3VwI/_buildManifest.js" defer=""></script><script src="/_next/static/nGLXNeF8szeowtdfA3VwI/_ssgManifest.js" defer=""></script></head><body class="bg-white text-gray-700 antialiased"><div id="__next"><div class="flex flex-col h-screen "><header class="py-8 lg:px-10 "><div class="px-2 md:px-8 relative"><nav class="flex space-x-6 text-zinc-400 tracking-wide items-center justify-between "><a class="text-xl ml-4 " href="/"><div class="flex flex-row gap-1 items-center content-center "><img alt="profile logo" loading="lazy" width="48" height="48" decoding="async" data-nimg="1" class="mr-2" style="color:transparent" srcSet="https://aadiimages.imgix.net//aaditya-profile.png?w=48&amp;q=75 1x, https://aadiimages.imgix.net//aaditya-profile.png?w=96&amp;q=75 2x" src="https://aadiimages.imgix.net//aaditya-profile.png?w=96&amp;q=75"/> <span class="font-bold text-black">Aaditya</span> <span>Chapagain</span></div></a><div class="grow h-full"> </div><div class="hidden lg:flex space-x-6 text-zinc-400 tracking-wide items-center justify-between "><a class=" undefined" href="/">About Me</a><a class=" undefined" href="/posts">Logs</a><a class=" undefined" href="/projects">Projects</a><a class=" undefined" href="/sapiens">Thoughts</a><a class=" undefined" href="/resume">Resume</a><a class=" undefined" href="/contact">Contact</a></div><div class="flex lg:hidden border rounded-md p-2 mr-3 hover:bg-stone-200 "><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="font-size:24px;color:black"><path fill="currentColor" d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg></div></nav></div></header><div class="p-4 lg:p-8  inline-block grow "><main class="py-8 px-8 lg:px-0 "><div class="container max-w-3xl m-auto px-4"><div><article><header><h1 class="text-4xl font-bold">Wandb Your machine learning project.</h1><p class="mt-2 text-xl">Wandb Tool for visualizing and tracking your machine learning experiments better than tensorboard.</p><time class="flex mt-2 text-gray-400">3 years ago</time></header><div class="prose mt-10 "><p>Have you ever worked on large Machine learning projects or research where you have to manage many experimentations ? often during large projects or experiments you have to log every nits and bits of your Machine Learning training. Some of us might already be there.
Recently I was also working on large Machine learning Projects and it was very hard for me to track every experiments logs, visualization, experiments. There were lots of them and It would take lots of time to prepare presentation's of my experiments results to my peers and that's when I learned about wandb.</p>
<p>Wandb is API created by <a href="https://www.wandb.com/">Weights &#x26; Biases</a> to collect, manage and visualize all your Machine learning experiments all at one place. Ohh, wait you must be wandering that <strong>tensorboard</strong> can also do these things right ?</p>
<p>Well, there are lots of things which makes <strong>wandb</strong> a straight winner.</p>
<ol>
<li>Visually aesthetics UI.</li>
<li>More manageable and customizable visualization and experiment tracking.</li>
<li>Super easy to use API.</li>
<li>Analyze system usage metrics alongside runs.</li>
<li>Collaborate with team members</li>
<li>Run parameter sweeps</li>
<li>Keep records of experiments available forever</li>
</ol>
<p>I think the last point in above list is super cool, which is not feasible to do with tensorboard i.e You have to write huge amount of code by yourself to log these system wide metrics into tensorboard, but with wandb you can do this with just one line of code. and</p>
<p>Lets Dive into wandb API.</p>
<h1 id="installation">Installation</h1>
<p>Installing <code>wandb</code> is very easy, just run below command in terminal and you are good to go.</p>
<pre><code class="hljs language-bash">pip install wandb

pip install wandb --upgrade
</code></pre>
<p>One thing I noticed during installing wandb is that, if we run only <code>pip install wandb</code> it will sometimes only install wrapper class of wandb. So, upgrading wandb library after installing it , worked for me.</p>
<h1 id="integration-with-your-python-code">Integration with your python code</h1>
<p>You can use <code>wandb</code> with any deeplearning framework, either it is pytorch or Tensorflow.But, first you need to have account on <a href="https://www.wandb.com/">Weights &#x26; Biases</a>. After you create account on <a href="https://www.wandb.com/">Weights &#x26; Biases</a> , you can get your wandb api keys from <a href="https://app.wandb.ai/settings">setting</a>. After you get your keys, you just need to write couple of code to integrate your deeplearning system with wandb logger.</p>
<h2 id="login">Login</h2>
<p>First you need to login into your wandb using wandb API KEYS. you can login programetically or from terminal, but login using terminal is advised.</p>
<pre><code class="hljs language-bash"><span class="hljs-comment"># This is secret and shouldn't be checked into version control</span>
<span class="hljs-built_in">export</span> WANDB_API_KEY=<span class="hljs-variable">$YOUR_API_KEY</span>

wandb login
</code></pre>
<p>To Programatically login you can use following code:</p>
<pre><code class="hljs language-python">WANDB_API_KEYS = <span class="hljs-string">"&#x3C;your api keys here>"</span>

<span class="hljs-keyword">import</span> wandb

wandb.login(WANDB_API_KEYS) <span class="hljs-comment"># if you don't have $WANDB_API_KEYS in your env variable (Not Advised)</span>

wandb.login() <span class="hljs-comment"># if $WANDB_API_KEYS is already been set.</span>
</code></pre>
<h2 id="initializing-wandb--wandbinit-">Initializing wandb ( wandb.init )</h2>
<p>Below you will see simple wandb integration examples with keras.</p>
<pre><code class="hljs language-python">
<span class="hljs-comment"># initialize wandb with your project name and optionally with configutations.</span>
wandb.init(project=<span class="hljs-string">'demo-keras-integration'</span>, name = <span class="hljs-string">'first_run'</span>
           config={
              <span class="hljs-string">"learning_rate"</span>: <span class="hljs-number">0.005</span>,
              <span class="hljs-string">"epochs"</span>: <span class="hljs-number">25</span>,
              <span class="hljs-string">"batch_size"</span>: <span class="hljs-number">64</span>,
              <span class="hljs-string">"loss_function"</span>: <span class="hljs-string">"sparse_categorical_crossentropy"</span>,
              <span class="hljs-string">"architecture"</span>: <span class="hljs-string">"CNN"</span>,
              <span class="hljs-string">"dataset"</span>: <span class="hljs-string">"CIFAR-10"</span>,
           }, anonymous=<span class="hljs-string">'never'</span>)
config = wandb.config

<span class="hljs-comment"># Initialize model like you usually do.</span>
tf.keras.backend.clear_session()
model = Model()
model.summary()

<span class="hljs-comment"># compile model like you usually do.</span>
<span class="hljs-comment"># notice use of config.</span>
optimizer = tf.keras.optimizers.Adam(config.learning_rate)
model.<span class="hljs-built_in">compile</span>(optimizer, config.loss_function, metrics=[<span class="hljs-string">'acc'</span>])

</code></pre>
<p><code>project</code> is name of your project and your project might have different run, so <code>name</code> parameter will distinguish one run from other.
If you run above code and get back to your wandb dashboard it will new project called <code>demo-keras-integration</code> and with <code>first_run</code> in it.</p>
<p><a href="https://ibb.co/hDjwC6s"><img src="/images/wandb-init.png" alt="wandb Init"></a></p>
<p>Above init configuration will create new run everytime you call <code>wandb.init</code> But sometimes that not what you want, If your training is preemptible and might takes days or months to complete then you can resume from previous logged metrics by providing <code>resume = True</code> parameter to <code>wandb.init</code> and you will also need to set unique id, to distinguish one run from another. Below code will resume your logs with current run in your wandb dashboard even after you run <code>init</code> multiple times.</p>
<pre><code class="hljs language-python">
wandb.init(project=<span class="hljs-string">'demo-keras-integration'</span>, name = <span class="hljs-string">'first_run'</span>, resume= <span class="hljs-literal">True</span>,
            <span class="hljs-built_in">id</span> = <span class="hljs-string">'my_first_run'</span>
           config={
              <span class="hljs-string">"learning_rate"</span>: <span class="hljs-number">0.005</span>,
              <span class="hljs-string">"epochs"</span>: <span class="hljs-number">25</span>,
              <span class="hljs-string">"batch_size"</span>: <span class="hljs-number">64</span>,
              <span class="hljs-string">"loss_function"</span>: <span class="hljs-string">"sparse_categorical_crossentropy"</span>,
              <span class="hljs-string">"architecture"</span>: <span class="hljs-string">"CNN"</span>,
              <span class="hljs-string">"dataset"</span>: <span class="hljs-string">"CIFAR-10"</span>,
           }, anonymous=<span class="hljs-string">'never'</span>)
</code></pre>
<h2 id="train-with-wandb-callback">Train with Wandb callback</h2>
<p>wandb made easy to log your model metrics into your project space by providing various callback function to log your metrics directly into wandb dashboard, without writing extra code.</p>
<pre><code class="hljs language-python">
<span class="hljs-keyword">from</span> wandb.keras <span class="hljs-keyword">import</span> WandbCallback

<span class="hljs-comment"># train with our favorite model.fit</span>
<span class="hljs-comment"># notice WandbCallback used as a regular callback</span>
<span class="hljs-comment"># notice the use of config</span>
_ = model.fit(x_train, y_train,
          epochs=config.epochs,
          batch_size=config.batch_size,
          validation_data=(x_test, y_test),
          callbacks=[WandbCallback()])

</code></pre>
<p>If you are working on images and need a way to log your correctly classified and misclassified sample images, you can also do so using wandb. Below you will see the examples of it.</p>
<pre><code class="hljs language-python">
<span class="hljs-comment"># in order to get prediction on small subset of images.</span>
val_images, val_labels = x_test[:<span class="hljs-number">32</span>], y_test[:<span class="hljs-number">32</span>]

<span class="hljs-comment"># train with our favorite model.fit</span>
<span class="hljs-comment"># notice WandbCallback used as a regular callback</span>
<span class="hljs-comment"># notice that we are passing in some arguments as well</span>
<span class="hljs-comment"># notice the use of config</span>
_ = model.fit(x_train, y_train,
          epochs=config.epochs,
          batch_size=config.batch_size,
          validation_data=(x_test, y_test),
          callbacks=[WandbCallback(data_type=<span class="hljs-string">'image'</span>,
                                   training_data=(val_images, val_labels),
                                   labels=CLASS_NAMES)])
</code></pre>
<p><a href="https://ibb.co/ZcbvNP9"><img src="/images/wand-log-images.png" alt="logging images with wandb"></a></p>
<h2 id="log-custom-metrics-with-wandblog">Log Custom metrics with wandb.log</h2>
<p>You can always log custom metrics and extra information using wandb.log .</p>
<pre><code class="hljs language-python">loss, accuracy = model.evaluate(x_test, y_test)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'Test Error Rate: '</span>, <span class="hljs-built_in">round</span>((<span class="hljs-number">1</span>-accuracy)*<span class="hljs-number">100</span>, <span class="hljs-number">2</span>))

<span class="hljs-comment"># notice the use of wandb.log.</span>
<span class="hljs-comment"># We can easiy pass in values as key-value pairs.</span>
wandb.log({<span class="hljs-string">'Test Error Rate'</span>: <span class="hljs-built_in">round</span>((<span class="hljs-number">1</span>-accuracy)*<span class="hljs-number">100</span>, <span class="hljs-number">2</span>)})

</code></pre>
<h1 id="wandb-dashboard">wandb Dashboard</h1>
<p><a href="https://ibb.co/tBZDJzW"><img src="/images/wandb-dashboard.png" alt="Wandb dashboard"></a></p>
<p>You can see all your logged metrics in your wandb project dashboard. Wandb Groups information into different sections like Overview, Charts ,logs, system, model and files.</p>
<h2 id="overview">Overview</h2>
<p><a href="https://ibb.co/RvNFHTW"><img src="/images/wandb-overview.png" alt="Wandb dashboard"></a></p>
<p>The information in the <code>overview</code> section is pretty intuitive and self-explanatory. However, the Git Repository field and the Git State field are worthy of special mention. You can run the checkout command in the Git State field to pin down the exact code for reproducing the experiment. Under the hood, wandb tracks all the changes you made to the original repo, and save the "diff" files in a local directory. In this way, you can easily switch between different versions of the code without manually pushing the change to the remote repo.</p>
<h2 id="logs">Logs</h2>
<p>The <code>logs</code> section shows the console output during the experiment. This is useful for debugging the performance of the model.</p>
<p><a href="https://ibb.co/hmKFC7H"><img src="/images/wandb-logs.png" alt="Wandb dashboard"></a></p>
<h2 id="systems">Systems</h2>
<p>To me, the system section is where wandb really shines and separates itself from other options such as TensorBoard. It is a centralized place to track system utilization during the experiment. There are in total of 8 graphs displayed in this section. These graphs give you insight into the training bottleneck and possible ways to uplift it. For example, below are the diagrams of the experiment:</p>
<p><a href="https://ibb.co/VNGQbyQ"><img src="/images/wandb-system.png" alt="Wandb dashboard"></a></p>
<h2 id="tensorboard">Tensorboard</h2>
<p>wandb also provide options for people who love tensorboard. You can directly sync wandb with tensorboard by just setting <code>sync_tensorboard = True</code> in your <code>wandb.init</code>. So, that every information that is logged into tensorboard will also be logged into wandb.</p>
<pre><code class="hljs language-python">
wandb.init(
    name = <span class="hljs-string">'&#x3C;your run name>'</span>,
    project = <span class="hljs-string">'your project name'</span>,
    config = <span class="hljs-string">'&#x3C;your config>'</span>,
    sync_tensorboard = <span class="hljs-literal">True</span>)
</code></pre>
<h1 id="summary">Summary</h1>
<p>We discuss how to integrate wandb in any deeplearning framework using python for inspecting the efficiency of training jobs. We also looked into other aspects of wandb that makes it so much unique than other training logging software like tensorboard.</p>
<p>To learn more about wandb, check out their website: <a href="https://www.wandb.com/">https://www.wandb.com/</a>.</p></div></article><div class="mt-20"><form><textarea class="flex w-full max-h-40 p-3 rounded resize-y bg-gray-200 text-gray-900 placeholder-gray-500" rows="2" placeholder="Please login to leave a comment" disabled=""></textarea><div class="flex items-center mt-4"><button type="button" class="py-2 px-4 rounded bg-blue-600 text-white disabled:opacity-40 hover:bg-blue-700">Log In</button></div></form><div class="space-y-6 mt-10"></div></div></div></div></main></div><div class="static inset-x-0 bottom-0 content-center py-6 "><div class="flex flex-auto px-6 text-slate-400 gap-1.5 font-semibold "><div class="grow h-16 "> </div><div class="flex flex-col gap-1.5 items-center content-between "><div class="flex flex-auto items-center gap-2 "><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="copyright" class="svg-inline--fa fa-copyright " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="font-size:20px"><path fill="currentColor" d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM199.4 312.6c-31.2-31.2-31.2-81.9 0-113.1s81.9-31.2 113.1 0c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9c-50-50-131-50-181 0s-50 131 0 181s131 50 181 0c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0c-31.2 31.2-81.9 31.2-113.1 0z"></path></svg><span>   2023  </span><span>Aaditya Chapagain</span></div><div class="ml-2 ">All Rights Reserved</div></div><div class="grow h-16 "> </div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"wandb-your-machine-learning-project","title":"Wandb Your machine learning project.","date":"2020-09-02 12:00","modified":"2020-09-02 12:00","category":"Blog","summary":"Wandb Tool for visualizing and tracking your machine learning experiments better than tensorboard.","tags":"Datasets, Machine Learning, Visualization, training, Deep Learning, ML tools, tensorboard, python","authors":["Aaditya Chapagain"],"status":"published","content":"\u003cp\u003eHave you ever worked on large Machine learning projects or research where you have to manage many experimentations ? often during large projects or experiments you have to log every nits and bits of your Machine Learning training. Some of us might already be there.\nRecently I was also working on large Machine learning Projects and it was very hard for me to track every experiments logs, visualization, experiments. There were lots of them and It would take lots of time to prepare presentation's of my experiments results to my peers and that's when I learned about wandb.\u003c/p\u003e\n\u003cp\u003eWandb is API created by \u003ca href=\"https://www.wandb.com/\"\u003eWeights \u0026#x26; Biases\u003c/a\u003e to collect, manage and visualize all your Machine learning experiments all at one place. Ohh, wait you must be wandering that \u003cstrong\u003etensorboard\u003c/strong\u003e can also do these things right ?\u003c/p\u003e\n\u003cp\u003eWell, there are lots of things which makes \u003cstrong\u003ewandb\u003c/strong\u003e a straight winner.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eVisually aesthetics UI.\u003c/li\u003e\n\u003cli\u003eMore manageable and customizable visualization and experiment tracking.\u003c/li\u003e\n\u003cli\u003eSuper easy to use API.\u003c/li\u003e\n\u003cli\u003eAnalyze system usage metrics alongside runs.\u003c/li\u003e\n\u003cli\u003eCollaborate with team members\u003c/li\u003e\n\u003cli\u003eRun parameter sweeps\u003c/li\u003e\n\u003cli\u003eKeep records of experiments available forever\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eI think the last point in above list is super cool, which is not feasible to do with tensorboard i.e You have to write huge amount of code by yourself to log these system wide metrics into tensorboard, but with wandb you can do this with just one line of code. and\u003c/p\u003e\n\u003cp\u003eLets Dive into wandb API.\u003c/p\u003e\n\u003ch1 id=\"installation\"\u003eInstallation\u003c/h1\u003e\n\u003cp\u003eInstalling \u003ccode\u003ewandb\u003c/code\u003e is very easy, just run below command in terminal and you are good to go.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003epip install wandb\n\npip install wandb --upgrade\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOne thing I noticed during installing wandb is that, if we run only \u003ccode\u003epip install wandb\u003c/code\u003e it will sometimes only install wrapper class of wandb. So, upgrading wandb library after installing it , worked for me.\u003c/p\u003e\n\u003ch1 id=\"integration-with-your-python-code\"\u003eIntegration with your python code\u003c/h1\u003e\n\u003cp\u003eYou can use \u003ccode\u003ewandb\u003c/code\u003e with any deeplearning framework, either it is pytorch or Tensorflow.But, first you need to have account on \u003ca href=\"https://www.wandb.com/\"\u003eWeights \u0026#x26; Biases\u003c/a\u003e. After you create account on \u003ca href=\"https://www.wandb.com/\"\u003eWeights \u0026#x26; Biases\u003c/a\u003e , you can get your wandb api keys from \u003ca href=\"https://app.wandb.ai/settings\"\u003esetting\u003c/a\u003e. After you get your keys, you just need to write couple of code to integrate your deeplearning system with wandb logger.\u003c/p\u003e\n\u003ch2 id=\"login\"\u003eLogin\u003c/h2\u003e\n\u003cp\u003eFirst you need to login into your wandb using wandb API KEYS. you can login programetically or from terminal, but login using terminal is advised.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-comment\"\u003e# This is secret and shouldn't be checked into version control\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003eexport\u003c/span\u003e WANDB_API_KEY=\u003cspan class=\"hljs-variable\"\u003e$YOUR_API_KEY\u003c/span\u003e\n\nwandb login\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo Programatically login you can use following code:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eWANDB_API_KEYS = \u003cspan class=\"hljs-string\"\u003e\"\u0026#x3C;your api keys here\u003e\"\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e wandb\n\nwandb.login(WANDB_API_KEYS) \u003cspan class=\"hljs-comment\"\u003e# if you don't have $WANDB_API_KEYS in your env variable (Not Advised)\u003c/span\u003e\n\nwandb.login() \u003cspan class=\"hljs-comment\"\u003e# if $WANDB_API_KEYS is already been set.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"initializing-wandb--wandbinit-\"\u003eInitializing wandb ( wandb.init )\u003c/h2\u003e\n\u003cp\u003eBelow you will see simple wandb integration examples with keras.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\n\u003cspan class=\"hljs-comment\"\u003e# initialize wandb with your project name and optionally with configutations.\u003c/span\u003e\nwandb.init(project=\u003cspan class=\"hljs-string\"\u003e'demo-keras-integration'\u003c/span\u003e, name = \u003cspan class=\"hljs-string\"\u003e'first_run'\u003c/span\u003e\n           config={\n              \u003cspan class=\"hljs-string\"\u003e\"learning_rate\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0.005\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"epochs\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"batch_size\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"loss_function\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"sparse_categorical_crossentropy\"\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"architecture\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"CNN\"\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"dataset\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"CIFAR-10\"\u003c/span\u003e,\n           }, anonymous=\u003cspan class=\"hljs-string\"\u003e'never'\u003c/span\u003e)\nconfig = wandb.config\n\n\u003cspan class=\"hljs-comment\"\u003e# Initialize model like you usually do.\u003c/span\u003e\ntf.keras.backend.clear_session()\nmodel = Model()\nmodel.summary()\n\n\u003cspan class=\"hljs-comment\"\u003e# compile model like you usually do.\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# notice use of config.\u003c/span\u003e\noptimizer = tf.keras.optimizers.Adam(config.learning_rate)\nmodel.\u003cspan class=\"hljs-built_in\"\u003ecompile\u003c/span\u003e(optimizer, config.loss_function, metrics=[\u003cspan class=\"hljs-string\"\u003e'acc'\u003c/span\u003e])\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eproject\u003c/code\u003e is name of your project and your project might have different run, so \u003ccode\u003ename\u003c/code\u003e parameter will distinguish one run from other.\nIf you run above code and get back to your wandb dashboard it will new project called \u003ccode\u003edemo-keras-integration\u003c/code\u003e and with \u003ccode\u003efirst_run\u003c/code\u003e in it.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://ibb.co/hDjwC6s\"\u003e\u003cimg src=\"/images/wandb-init.png\" alt=\"wandb Init\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eAbove init configuration will create new run everytime you call \u003ccode\u003ewandb.init\u003c/code\u003e But sometimes that not what you want, If your training is preemptible and might takes days or months to complete then you can resume from previous logged metrics by providing \u003ccode\u003eresume = True\u003c/code\u003e parameter to \u003ccode\u003ewandb.init\u003c/code\u003e and you will also need to set unique id, to distinguish one run from another. Below code will resume your logs with current run in your wandb dashboard even after you run \u003ccode\u003einit\u003c/code\u003e multiple times.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\nwandb.init(project=\u003cspan class=\"hljs-string\"\u003e'demo-keras-integration'\u003c/span\u003e, name = \u003cspan class=\"hljs-string\"\u003e'first_run'\u003c/span\u003e, resume= \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e,\n            \u003cspan class=\"hljs-built_in\"\u003eid\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'my_first_run'\u003c/span\u003e\n           config={\n              \u003cspan class=\"hljs-string\"\u003e\"learning_rate\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0.005\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"epochs\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"batch_size\"\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e64\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"loss_function\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"sparse_categorical_crossentropy\"\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"architecture\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"CNN\"\u003c/span\u003e,\n              \u003cspan class=\"hljs-string\"\u003e\"dataset\"\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\"CIFAR-10\"\u003c/span\u003e,\n           }, anonymous=\u003cspan class=\"hljs-string\"\u003e'never'\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"train-with-wandb-callback\"\u003eTrain with Wandb callback\u003c/h2\u003e\n\u003cp\u003ewandb made easy to log your model metrics into your project space by providing various callback function to log your metrics directly into wandb dashboard, without writing extra code.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\n\u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e wandb.keras \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e WandbCallback\n\n\u003cspan class=\"hljs-comment\"\u003e# train with our favorite model.fit\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# notice WandbCallback used as a regular callback\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# notice the use of config\u003c/span\u003e\n_ = model.fit(x_train, y_train,\n          epochs=config.epochs,\n          batch_size=config.batch_size,\n          validation_data=(x_test, y_test),\n          callbacks=[WandbCallback()])\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf you are working on images and need a way to log your correctly classified and misclassified sample images, you can also do so using wandb. Below you will see the examples of it.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\n\u003cspan class=\"hljs-comment\"\u003e# in order to get prediction on small subset of images.\u003c/span\u003e\nval_images, val_labels = x_test[:\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e], y_test[:\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e]\n\n\u003cspan class=\"hljs-comment\"\u003e# train with our favorite model.fit\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# notice WandbCallback used as a regular callback\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# notice that we are passing in some arguments as well\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# notice the use of config\u003c/span\u003e\n_ = model.fit(x_train, y_train,\n          epochs=config.epochs,\n          batch_size=config.batch_size,\n          validation_data=(x_test, y_test),\n          callbacks=[WandbCallback(data_type=\u003cspan class=\"hljs-string\"\u003e'image'\u003c/span\u003e,\n                                   training_data=(val_images, val_labels),\n                                   labels=CLASS_NAMES)])\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ca href=\"https://ibb.co/ZcbvNP9\"\u003e\u003cimg src=\"/images/wand-log-images.png\" alt=\"logging images with wandb\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"log-custom-metrics-with-wandblog\"\u003eLog Custom metrics with wandb.log\u003c/h2\u003e\n\u003cp\u003eYou can always log custom metrics and extra information using wandb.log .\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003eloss, accuracy = model.evaluate(x_test, y_test)\n\u003cspan class=\"hljs-built_in\"\u003eprint\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'Test Error Rate: '\u003c/span\u003e, \u003cspan class=\"hljs-built_in\"\u003eround\u003c/span\u003e((\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-accuracy)*\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n\n\u003cspan class=\"hljs-comment\"\u003e# notice the use of wandb.log.\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# We can easiy pass in values as key-value pairs.\u003c/span\u003e\nwandb.log({\u003cspan class=\"hljs-string\"\u003e'Test Error Rate'\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003eround\u003c/span\u003e((\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e-accuracy)*\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)})\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1 id=\"wandb-dashboard\"\u003ewandb Dashboard\u003c/h1\u003e\n\u003cp\u003e\u003ca href=\"https://ibb.co/tBZDJzW\"\u003e\u003cimg src=\"/images/wandb-dashboard.png\" alt=\"Wandb dashboard\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eYou can see all your logged metrics in your wandb project dashboard. Wandb Groups information into different sections like Overview, Charts ,logs, system, model and files.\u003c/p\u003e\n\u003ch2 id=\"overview\"\u003eOverview\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://ibb.co/RvNFHTW\"\u003e\u003cimg src=\"/images/wandb-overview.png\" alt=\"Wandb dashboard\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThe information in the \u003ccode\u003eoverview\u003c/code\u003e section is pretty intuitive and self-explanatory. However, the Git Repository field and the Git State field are worthy of special mention. You can run the checkout command in the Git State field to pin down the exact code for reproducing the experiment. Under the hood, wandb tracks all the changes you made to the original repo, and save the \"diff\" files in a local directory. In this way, you can easily switch between different versions of the code without manually pushing the change to the remote repo.\u003c/p\u003e\n\u003ch2 id=\"logs\"\u003eLogs\u003c/h2\u003e\n\u003cp\u003eThe \u003ccode\u003elogs\u003c/code\u003e section shows the console output during the experiment. This is useful for debugging the performance of the model.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://ibb.co/hmKFC7H\"\u003e\u003cimg src=\"/images/wandb-logs.png\" alt=\"Wandb dashboard\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"systems\"\u003eSystems\u003c/h2\u003e\n\u003cp\u003eTo me, the system section is where wandb really shines and separates itself from other options such as TensorBoard. It is a centralized place to track system utilization during the experiment. There are in total of 8 graphs displayed in this section. These graphs give you insight into the training bottleneck and possible ways to uplift it. For example, below are the diagrams of the experiment:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://ibb.co/VNGQbyQ\"\u003e\u003cimg src=\"/images/wandb-system.png\" alt=\"Wandb dashboard\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"tensorboard\"\u003eTensorboard\u003c/h2\u003e\n\u003cp\u003ewandb also provide options for people who love tensorboard. You can directly sync wandb with tensorboard by just setting \u003ccode\u003esync_tensorboard = True\u003c/code\u003e in your \u003ccode\u003ewandb.init\u003c/code\u003e. So, that every information that is logged into tensorboard will also be logged into wandb.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-python\"\u003e\nwandb.init(\n    name = \u003cspan class=\"hljs-string\"\u003e'\u0026#x3C;your run name\u003e'\u003c/span\u003e,\n    project = \u003cspan class=\"hljs-string\"\u003e'your project name'\u003c/span\u003e,\n    config = \u003cspan class=\"hljs-string\"\u003e'\u0026#x3C;your config\u003e'\u003c/span\u003e,\n    sync_tensorboard = \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1 id=\"summary\"\u003eSummary\u003c/h1\u003e\n\u003cp\u003eWe discuss how to integrate wandb in any deeplearning framework using python for inspecting the efficiency of training jobs. We also looked into other aspects of wandb that makes it so much unique than other training logging software like tensorboard.\u003c/p\u003e\n\u003cp\u003eTo learn more about wandb, check out their website: \u003ca href=\"https://www.wandb.com/\"\u003ehttps://www.wandb.com/\u003c/a\u003e.\u003c/p\u003e"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"wandb-your-machine-learning-project"},"buildId":"nGLXNeF8szeowtdfA3VwI","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>