<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="Tech, life, uprising , upbringing, futuristic logbook made with love."/><title>Welcome to Aaditya Chapagain&#x27;s notebook!</title><meta name="next-head-count" content="4"/><meta charSet="utf-8"/><meta name="robots" content="follow, index"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><link rel="preload" href="/_next/static/css/7accd83e12becce3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7accd83e12becce3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-ff44f97138765e5a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9ab3109eae2e0467.js" defer=""></script><script src="/_next/static/chunks/281-2503d455e5b415a8.js" defer=""></script><script src="/_next/static/chunks/pages/posts-74a8b6a81ca62367.js" defer=""></script><script src="/_next/static/m2JRtbAfLxgfVm-l9xa4W/_buildManifest.js" defer=""></script><script src="/_next/static/m2JRtbAfLxgfVm-l9xa4W/_ssgManifest.js" defer=""></script></head><body class="bg-white text-gray-700 antialiased"><div id="__next"><header class="py-8 lg:px-10 "><div class="px-2 md:px-8 relative"><nav class="flex space-x-6 text-zinc-400 tracking-wide items-center justify-between "><a class="text-xl ml-4 " href="/"><div class="flex flex-row gap-1 items-center content-center "><img alt="profile logo" srcSet="https://aadiimages.imgix.net//aaditya-profile.png?w=48&amp;q=75 1x, https://aadiimages.imgix.net//aaditya-profile.png?w=96&amp;q=75 2x" src="https://aadiimages.imgix.net//aaditya-profile.png?w=96&amp;q=75" width="48" height="48" decoding="async" data-nimg="1" class="mr-2" loading="lazy" style="color:transparent"/> <span class="font-bold text-black">Aaditya</span> <span>Chapagain</span></div></a><div class="grow h-full"> </div><div class="hidden lg:flex space-x-6 text-zinc-400 tracking-wide items-center justify-between "><a class=" undefined" href="/">About Me</a><a class="text-black font-semibold" href="/posts">Logs</a><a class=" undefined" href="/projects">Projects</a><a class=" undefined" href="/sapiens">Thoughts</a><a class=" undefined" href="/resume">Resume</a><a class=" undefined" href="/contact">Contact</a></div><div class="flex lg:hidden border rounded-md p-2 mr-3 hover:bg-stone-200 "><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="font-size:24px;color:black"><path fill="currentColor" d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg></div></nav></div></header><div class="p-4 lg:p-8 "><main class="py-8 px-8 lg:px-0 "><div class="container max-w-3xl m-auto px-4"><article class="mb-10"><a class="text-lg leading-6 font-bold" href="/posts/prancing-pony">At the Sign of the Prancing Pony</a><p>The Hobbits reach the The Prancing Pony inn at Bree, where Frodo uses a false name, Underhill.</p><div class="text-gray-400"><time>2 years ago</time></div></article><article class="mb-10"><a class="text-lg leading-6 font-bold" href="/posts/long-expected-party">A Long-expected Party</a><p>Gandalf arrives in the Shire for Bilbo&#x27;s Farewell Birthday Party. Bilbo leaves the Shire permanently.</p><div class="text-gray-400"><time>2 years ago</time></div></article><article class="mb-10"><a class="text-lg leading-6 font-bold" href="/posts/riders-of-rohan">The Riders of Rohan</a><p>Aragorn, Legolas, and Gimli follow the trail of the Orcs and find several clues as to what happened with Merry and Pippin.</p><div class="text-gray-400"><time>2 years ago</time></div></article><article class="mb-10"><a class="text-lg leading-6 font-bold" href="/posts/passing-of-grey-company">The Passing of the Grey Company</a><p>Aragorn, Legolas, and Gimli are accompanied by the Grey Company as they pass through the Paths of the Dead between Rohan and Gondor.</p><div class="text-gray-400"><time>2 years ago</time></div></article><article class="mb-10"><a class="text-lg leading-6 font-bold" href="/posts/speech-signal-processing-using-python">Speech Signal Processing using python</a><p>Signal Processing and Speech Recognition using python</p><div class="text-gray-400"><time>2 years ago</time></div></article></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"allPosts":[{"slug":"prancing-pony","title":"At the Sign of the Prancing Pony","date":"2021-03-03","modified":"","category":"","summary":"The Hobbits reach the The Prancing Pony inn at Bree, where Frodo uses a false name, Underhill.","tags":"","author":"","status":"","content":"\nPlaceat consequuntur ullam aut sapiente illo velit. Eius facere ut molestias\ntotam laborum pariatur quam. Praesentium quo veritatis expedita animi.\n\nQuite anything glass benefit. Such form clearly top tend can require my. Federal\ndegree sort performance region maintain.\n\nUt dignissimos sapiente culpa rerum pariatur consequatur. Corporis suscipit ad\ncorrupti aut. Expedita culpa aut deleniti officiis.\n\nPorro eum id sit quia expedita. Alias expedita asperiores. Corporis ex eum atque\ncum ea.\n"},{"slug":"long-expected-party","title":"A Long-expected Party","date":"2021-03-02","modified":"","category":"","summary":"Gandalf arrives in the Shire for Bilbo's Farewell Birthday Party. Bilbo leaves the Shire permanently.","tags":"","author":"","status":"","content":"\nPlaceat consequuntur ullam aut sapiente illo velit. Eius facere ut molestias\ntotam laborum pariatur quam. Praesentium quo veritatis expedita animi.\n\nQuite anything glass benefit. Such form clearly top tend can require my. Federal\ndegree sort performance region maintain.\n\nUt dignissimos sapiente culpa rerum pariatur consequatur. Corporis suscipit ad\ncorrupti aut. Expedita culpa aut deleniti officiis.\n\nPorro eum id sit quia expedita. Alias expedita asperiores. Corporis ex eum atque\ncum ea.\n"},{"slug":"riders-of-rohan","title":"The Riders of Rohan","date":"2021-02-01","modified":"","category":"","summary":"Aragorn, Legolas, and Gimli follow the trail of the Orcs and find several clues as to what happened with Merry and Pippin.","tags":"","author":"","status":"","content":"\nPlaceat consequuntur ullam aut sapiente illo velit. Eius facere ut molestias\ntotam laborum pariatur quam. Praesentium quo veritatis expedita animi.\n\nQuite anything glass benefit. Such form clearly top tend can require my. Federal\ndegree sort performance region maintain.\n\nUt dignissimos sapiente culpa rerum pariatur consequatur. Corporis suscipit ad\ncorrupti aut. Expedita culpa aut deleniti officiis.\n\nPorro eum id sit quia expedita. Alias expedita asperiores. Corporis ex eum atque\ncum ea.\n"},{"slug":"passing-of-grey-company","title":"The Passing of the Grey Company","date":"2021-01-22","modified":"","category":"","summary":"Aragorn, Legolas, and Gimli are accompanied by the Grey Company as they pass through the Paths of the Dead between Rohan and Gondor.","tags":"","author":"","status":"","content":"\nPlaceat consequuntur ullam aut sapiente illo velit. Eius facere ut molestias\ntotam laborum pariatur quam. Praesentium quo veritatis expedita animi.\n\nQuite anything glass benefit. Such form clearly top tend can require my. Federal\ndegree sort performance region maintain.\n\nUt dignissimos sapiente culpa rerum pariatur consequatur. Corporis suscipit ad\ncorrupti aut. Expedita culpa aut deleniti officiis.\n\nPorro eum id sit quia expedita. Alias expedita asperiores. Corporis ex eum atque\ncum ea.\n"},{"slug":"speech-signal-processing-using-python","title":"Speech Signal Processing using python","date":"2020-08-11 8:00","modified":"2020-08-11 8:00","category":"Blog","summary":"Signal Processing and Speech Recognition using python","tags":"signal processing, speech recognition, ASR, machine learning, Deep Learning.","author":"","status":"published","content":"\nSpeech processing is very first phase in any speech system either it is speech recognition system or speaker Diarization or something else. Speech processing plays an important role in speech system to extract vocal features i.e identify the components of the audio signal that are good for identifying the linguistic content and discarding all other stuff which carries information like background noise, emotion etc.  \n\nIn this post we will learn very important mathematical concept about speech processing in any speech system and implement the mathematics in python.\n\nMel Frequency Cepstral Coefficents (MFCCs) and Filter Banks are a feature widely used in automatic speech and speaker recognition. But Filter Banks is more popluar Nowadays due to its robustness on mapping vocal features.Computing filter banks and MFCCs involve somewhat same procedure, where in both cases filter banks are computed and with  a few more extra steps MFCCs can be obtained.\n\nLet's get started with loading speech signal with python. I will be using python 3.6 for this post.\n\n```python\n\nimport numpy as np\nfrom scipy.io import wavfile\nfrom scipy.fftpack import dct\nfrom matplotlib import pyplot as plt\n\nsample_rate, signal = wavfile.read('../audio/mfcc.wav')\n\nsignal = signal[0:int(10* sample_rate)]\nTime = np.linspace(0, len(signal) / sample_rate, num=len(signal))\n\nplt.plot(Time, signal)\n```\n\nThe raw signal has the following from in the time domain:\n[![raw signal image of speech](/images/spectral-image-speech.png)](https://ibb.co/nPvnTGc)\n\n## Pre-Emphasis\n\nThe first step is to apply a pre-emphesis filter on signal to amplify the high frequencies. A pre-emphesis filter is useful in several ways:\n - balance frequency spectrum since high frequencies usually have smaller magnitudes compared to lower frequencies\n - avoid numerical problems during fourier operation\n - Might also improve the signal to Noise Ratio (SNR)\n\nThe pre-emphesis filter can be applied to a signal x using the first order filter in the following equation:\n\n$$ y(t) = x(t) - \\alpha x(t-1) $$\n\nwhich can be easily implemented using the following line, where typical values for the filter coefficeint ( $\\alpha$ ) are 0.95 to 0.97, \n```pre_empasis = 0.97```\n\n```python\n\npre_emphasis = 0.97\nemphasized_signal = np.append(signal[0], signal[1:] - pre_emphasis * signal[:-1])\n\n```\nPre-emphasis has a modest effect in modern systems, mainly because most of the motivations for the pre-emphasis filter can be achieved using mean normalization except for avoiding the Fourier transfrom numerical issues which should not be a problem in modern FFT implementations.\n\nThe signal after pre-emphasis has the following effect in orignal signal.\n\n[![before and after pre-emphesis](/images/before-after-preemphesis.png)](https://ibb.co/Jqn0x33)\n\n## Framing\n\nAfter pre-emphasis, we need to split the signal into short-time frames. The rationale behind this step is that frequencies in a signal change over time, so in most cases it dosen't make sense to do the Fourier Transform across the entier signal in that we would lose the frequency contours of the signal over time. To avoid that, we can safely assume that frequencies in a signal are stationary over a very short period of time. Therefore, by doing a Fourier transform over this short-time frame, we can obtain a good approximation of the frequency contours of the signal by concatenating adjacent frames.\n\nTypical frame sizes in speech processing rnage from 20 ms to 40 ms with 50% (+/- 10%) overlap between conseutive frames.Popular settings are 25 ms for the frame size, frame_size = 0.025 and a 10 ms stride (15 ms overlap), frame_stride = 0.01\n\n```python\n\nframe_size = 0.025\nframe_stride = 0.01\n\nframe_length, frame_step = frame_size * sample_rate, frame_stride * sample_rate  # Convert from seconds to samples\nsignal_length = len(emphasized_signal)\nframe_length = int(round(frame_length))\nframe_step = int(round(frame_step))\nnum_frames = int(np.ceil(float(np.abs(signal_length - frame_length)) / frame_step))  # Make sure that we have at least 1 frame\n\npad_signal_length = num_frames * frame_step + frame_length\nz = np.zeros((pad_signal_length - signal_length))\npad_signal = np.append(emphasized_signal, z) # Pad Signal to make sure that all frames have equal number of samples without truncating any samples from the original signal\n\nindices = np.tile(np.arange(0, frame_length), (num_frames, 1)) + np.tile(np.arange(0, num_frames * frame_step, frame_step), (frame_length, 1)).T\nframes = pad_signal[indices.astype(np.int32, copy=False)]\n\n```\n\n## Window\n\nAfter slicing the signal into frames, we apply a window function such as the Hamming window to each frame. A Hamming window has the following form:\n$$ w[n] = 0.54 − 0.46 cos ( \\frac{2πn}{N − 1} ) $$\nwhere,  0 $\\leq$ n $\\leq$ N-1,N is the window length.\n\nThere are several reasons why we need to apply a window function to the frames, notably to counteract the assumption made by the FFT that the data is infinite and to reduce spectral leakage.\n\n```python\n\nframes *= np.hamming(frame_length)```\n# frames *= 0.54 - 0.46 * np.cos((2 * np.pi * n) / (frame_length - 1))  # Explicit Implementation **\n```\n\n## Fourier-Transfrom and Power Spectrum\n\nWe can now do an N-point FFT on each frame to calculate the frequency spectrum, which is also called Short-Time-Fourier-Transfrom (STFT), where N is typically 256 or 512, ```NFFT = 512```; and then compute the power spectrum (Periodogram) using the following equation: \n$$P = \\frac{|FFT(x_i)|^2}{N}$$\nwhere , $x_i$ is the $i^{th}$ frame of signal $x$. This can be easily imlemented with the following lines:\n\n```python\nNFFT = 512\n\nmag_frames = np.absolute(np.fft.rfft(frames, NFFT))  # Magnitude of the FFT\npow_frames = ((1.0 / NFFT) * ((mag_frames) ** 2))  # Power Spectrum\n```\n\n## Filter Banks\n\nThe final step to computing filter banks is applying triangular filters, typically 40 filters, nfilt = 40 on a Mel-scale to the power spectrum to extract frequency bands. The Mel-Scale aims to mimic the non-linear human ear perception of sound, by being more discriminative at lower frequenceis and less discriminative at higher frequencies. We can convert between Hertz ($f$) and Mel ( $m$) using the following equations:\n$$ \\Large m = 2595 \\log_{10} (1 + \\frac{f}{700}) \\approx  1125 \\ln (1 + \\frac{f}{700} )  $$\n\n$$ \\Large f = 700 ( 10^{ \\frac{m}{2595} } -1)$$\n\nEach filter in the filter bank is triangular having a response of 1 at the center frequency and decrease linearly towards 0 till it reaches the center frequencies of the two adjacent filters where the response is 0. which can be modeled by the following equation:\n\n$$\nH_m(k) =\n  \\begin{cases}\n      \\ 0                                      \u0026 k \u003c f(m - 1) \\\\\n      \\\\\n      \\dfrac{k - f(m - 1)}{f(m) - f(m - 1)}  \u0026 f(m - 1) \\leq k \u003c f(m) \\\\\n      \\\\\n      1                                      \u0026 k = f(m) \\\\\n      \\\\\n      \\dfrac{f(m + 1) - k}{f(m + 1) - f(m)}  \u0026 f(m) \u003c k \\leq f(m + 1) \\\\\n      \\\\\n      0                                      \u0026 k \u003e f(m + 1) \\\\\n  \\end{cases}\n  $$\n\n```python\nnfilt = 40\n\nlow_freq_mel = 0\nhigh_freq_mel = (2595 * np.log10(1 + (sample_rate / 2) / 700))  # Convert Hz to Mel\nmel_points = np.linspace(low_freq_mel, high_freq_mel, nfilt + 2)  # Equally spaced in Mel scale\nhz_points = (700 * (10**(mel_points / 2595) - 1))  # Convert Mel to Hz\nbin = np.floor((NFFT + 1) * hz_points / sample_rate)\n\nfbank = np.zeros((nfilt, int(np.floor(NFFT / 2 + 1))))\nfor m in range(1, nfilt + 1):\n    f_m_minus = int(bin[m - 1])   # left\n    f_m = int(bin[m])             # center\n    f_m_plus = int(bin[m + 1])    # right\n\n    for k in range(f_m_minus, f_m):\n        fbank[m - 1, k] = (k - bin[m - 1]) / (bin[m] - bin[m - 1])\n    for k in range(f_m, f_m_plus):\n        fbank[m - 1, k] = (bin[m + 1] - k) / (bin[m + 1] - bin[m])\nfilter_banks = np.dot(pow_frames, fbank.T)\nfilter_banks = np.where(filter_banks == 0, np.finfo(float).eps, filter_banks)  # Numerical Stability\nfilter_banks = 20 * np.log10(filter_banks)  # dB\n```\n\nAfter applying the filter bank to the power spectrum (peridogram) of the signal, we obtain the following spectrogram:\n\n```python\nfig, ax = plt.subplots(nrows=1, ncols=1, figsize=(20, 4))\ncax = ax.matshow(\n    np.transpose(filter_banks),\n    interpolation=\"nearest\",\n    aspect=\"auto\",\n    cmap=plt.cm.afmhot_r,\n    origin=\"lower\",\n)\nfig.colorbar(cax)\nplt.title(\"Mel compression Spectrogram\")\nplt.show()\n```\n\n[![melspectrogram of speech signal](/images/mfcc-spectorgram.png)](https://ibb.co/xSyfhsV)\n\n## Mel-frequency cepstral Coecfficents (MFCCs)\n\nIt turns out that filter bank coefficients computed in the previous step are higly correlated, which could be problematic in some machine learning algorithms. Therefore, we can apply Discrete Cosine Transform(DCT)  to decorrelate the filter bank coefficients and yield compressed representation of filter banks. Typically, for Automatic SPeech Recognition (ASR), the resulting cepstral coefficeints 2- 13 are retained and the rest are discareded; ```num_ceps = 12```. The reasons for discarding the other coefficeints is that they represent fast changes in the filter bank coefficients and these fine details don't contribute to ASR.\n\n```python\nnum_ceps = 12\nmfcc = dct(filter_banks, type = 2, axis=1, norm=\"ortho\")[:,1: (num_ceps + 1)] # keep 2-13\n\n```\nOne may apply sinusoidal liftering to the MFCCs to de-emphasize higher MFCCs which has been claimed to improve speech recognition in noisy signals.\n\n```python\n\ncep_lifter = 22\n(nframes, ncoeff) = mfcc.shape\nn = np.arange(ncoeff)\nlift = 1 + (cep_lifter / 2) * np.sin(np.pi * n/ cep_lifter)\nmfcc *= lift\n\nfig, ax = plt.subplots(nrows=1, ncols=1, figsize=(20, 4))\ncax = ax.matshow(\n    np.transpose(mfcc),\n    interpolation=\"nearest\",\n    aspect=\"auto\",\n    cmap=plt.cm.afmhot_r,\n    origin=\"lower\",\n)\nfig.colorbar(cax)\nplt.title(\"MFCC Spectrogram\")\nplt.show()\n```\n\n[![MFCC spectrogram of speech signal](/images/mel-spectrogram.png)](https://ibb.co/S7c5pnL)\n\n## Mean Normalization\n\nAs previously mentioned, to balance the spectrum and improve the Signal-to-Noise (SNR), we can simply substract the mean of each coefficeint from all frames,\n\n```python\nfilter_banks -= (np.mean(filter_banks, axis = 0) + 1e-8)\n```\n\nand similarly for MFCCs:\n\n```python\n\nmfcc -= (np.mean(mfcc, axis = 0) + 1e-8)\n\n```\n\nTo this point, the steps to compute filter banks and MFCCs were discussed in terms of their motivation and implementations.It is interesting to note that all steps needed to compute filter banks were motivated by the nature of the speech signal and the human perception of such signals. \n \n On the Contrary, the extra steps needed to compute MFCCs were motivated by the limitation of some classifical machine learning algorithms.The Discrete cosine Transfrom (DCT) was needed to decorrelate filter banks coeffiicients, a process refer as whitening. In particular, MFCCs were very popular with Gaussian Mixture Models - Hidden Markov Models(GMM - HMM).\n But with the advent of Deep learning in speech system, one might not need DCT.\n"}]},"__N_SSG":true},"page":"/posts","query":{},"buildId":"m2JRtbAfLxgfVm-l9xa4W","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>